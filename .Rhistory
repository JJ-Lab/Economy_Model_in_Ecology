library(tidyverse)
library(igraph)
folder_base <- "web-of-life_WDB/"
files_base <- list.files(folder_base)
for (i in files_base){
print(i)
}
list_files_field_level <- files_base[grepl("M_PL_", files_base)]
list_files <- files_base[grepl("M_PL_", files_base)]
i=1
# Extract the incidence matrix
inc_matrix <- read.csv(list_files[i], header=T, row.names=T)
# Extract the incidence matrix
inc_matrix <- read.csv(paste0(folder_base,list_files[i]), header=T, row.names=T)
paste0(folder_base,list_files[i])
# Extract the incidence matrix
inc_matrix <- read.csv(paste0(folder_base,list_files[i]), header=T, row.names=T)
# Extract the incidence matrix
inc_matrix <- read.csv(paste0(folder_base,list_files[i]), header=T, row.names=1)
View(inc_matrix)
# Create a graph for each layer
g_i <- graph_from_incidence_matrix(inc_matrix, directed = FALSE, weighted = T)
# Create a graph for each layer
g_i <- graph_from_incidence_matrix(inc_matrix, directed = FALSE, weighted = TRUE)
strength(g_i, weights = TRUE)
strength(g_i)
strengths_i <- strength(g_i)
V(g_i)
colnames(inc_matrix)
rownames(inc_matrix)
strength_plants <- strength(g_i,vids = plant_names)
plant_names <- rownames(inc_matrix)
strength_plants <- strength(g_i,vids = plant_names)
strength(g_i,vids = plant_names)
strength_poll <- strength(g_i,vids = poll_names)
library(fitdistrplus)
install.packages("fitdistrplus")
library(fitdistrplus)
plotdist(strength_plants, histo = TRUE, demp = TRUE)
plotdist(strength_plants, histo = TRUE, demp = TRUE,title="x")
fln <- fitdist(strength_plants, "lnorm")
# fitting
fln_plants <- fitdist(strength_plants, "lnorm")
denscomp(fln_plants)
qqcomp(fln_plants)
cdfcomp(fln_plants)
ppcomp(fln_plants)
# fitting
fln_plants <- fitdist(strength_plants, "lnorm")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "lognormal", "gamma")
denscomp(fln_plants)
qqcomp(fln_plants)
cdfcomp(fln_plants)
ppcomp(fln_plants)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1, line=-0.5)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1, line=-10.5)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1, line=-1)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1, line=-1.3)
# fitting
fln_plants <- fitdist(strength_plants, "lnorm")
par(mfrow = c(2, 2))
plot.legend <- c("Weibull", "lognormal", "gamma")
denscomp(fln_plants)
qqcomp(fln_plants)
cdfcomp(fln_plants)
ppcomp(fln_plants)
mtext(paste0("Plants in ",list_files[i]), outer=TRUE,  cex=1, line=-1.3)
pdf(paste0("fit/Plants_in",list_files[i],"pdf"),
width = 11.69, # The width of the plot in inches
height = 8.27)
list_files[i]
split(list_files[i],".csv")
strsplit(list_files[i],".csv")
name_i <- strsplit(list_files[i],".csv")
name_i[[1]]
paste0("fit/Plants_in",name_i[[1]],".pdf")
fln_poll <- fitdist(strength_poll, "lnorm")
strength_poll <- strength(g_i,vids = poll_names)
plant_names <- rownames(inc_matrix)
# Extract plant and pollinator labels, respectively
poll_names <- colnames(inc_matrix)
strength_poll <- strength(g_i,vids = poll_names)
fln_poll <- fitdist(strength_poll, "lnorm")
par(mfrow = c(2, 2))
denscomp(fln_poll)
qqcomp(fln_poll)
cdfcomp(fln_poll)
ppcomp(fln_poll)
mtext(paste0("Pollinators in ",list_files[i]," (MLE)"), outer=TRUE,  cex=1, line=-1.3)
for (i in seq(length(list_files))){
# Extract the incidence matrix
inc_matrix <- read.csv(paste0(folder_base,list_files[i]), header=TRUE, row.names=1)
# Create a graph for each layer
g_i <- graph_from_incidence_matrix(inc_matrix, directed = FALSE, weighted = TRUE)
# Extract plant and pollinator labels, respectively
poll_names <- colnames(inc_matrix)
plant_names <- rownames(inc_matrix)
# Calcualte plant and pollinator strengths, respectively
strength_plants <- strength(g_i,vids = plant_names)
strength_poll <- strength(g_i,vids = poll_names)
#plotdist(strength_plants, histo = TRUE, demp = TRUE)
# fitting log-normal distributions to data
name_i <- strsplit(list_files[i],".csv")
pdf(paste0("lnor_fit_plots/Plants_in_",name_i[[1]],".pdf"),
width = 11.69, # The width of the plot in inches
height = 8.27)
fln_plants <- fitdist(strength_plants, "lnorm")
par(mfrow = c(2, 2))
denscomp(fln_plants)
qqcomp(fln_plants)
cdfcomp(fln_plants)
ppcomp(fln_plants)
mtext(paste0("Plants in ",list_files[i]," (MLE)"), outer=TRUE,  cex=1, line=-1.3)
dev.off()
pdf(paste0("lnor_fit_plots/Pollinators_in_",name_i[[1]],".pdf"),
width = 11.69, # The width of the plot in inches
height = 8.27)
fln_poll <- fitdist(strength_poll, "lnorm")
par(mfrow = c(2, 2))
denscomp(fln_poll)
qqcomp(fln_poll)
cdfcomp(fln_poll)
ppcomp(fln_poll)
mtext(paste0("Pollinators in ",list_files[i]," (MLE)"), outer=TRUE,  cex=1, line=-1.3)
dev.off()
}
